From c9a1f2da68d7241c66e379540d824d238574a982 Mon Sep 17 00:00:00 2001
From: VitalyPolezhay <>
Date: Thu, 21 Sep 2023 13:12:36 +0300
Subject: [PATCH] fixed bug with transform image to color pixel array

---
 Crafty Craft 5/Extensions/UIImage+Resized.swift            | 7 ++++---
 .../SkinCreatorImportViewController.swift                  | 6 +++++-
 2 files changed, 9 insertions(+), 4 deletions(-)

diff --git a/Crafty Craft 5/Extensions/UIImage+Resized.swift b/Crafty Craft 5/Extensions/UIImage+Resized.swift
index 1c8ea7b..bda4fb3 100755
--- a/Crafty Craft 5/Extensions/UIImage+Resized.swift	
+++ b/Crafty Craft 5/Extensions/UIImage+Resized.swift	
@@ -109,8 +109,9 @@ extension UIImage {
         var colorArray: [UIColor] = []
         var coloredPixelsArr = [UIColor]()
         
-        for y in 0..<rectHeight {
-            for x in 0..<rectWidth {
+        for x in 0..<rectWidth {
+            for y in 0..<rectHeight {
+            
                 let offsetX = x + localStartX
                 let offsetY = y + localStartY
                 let offset = (offsetY * imgTotalWidth + offsetX) * bytesPerPixel
@@ -130,7 +131,7 @@ extension UIImage {
         
         //        AppDelegate.log("coloredPixelsArr.count = \(coloredPixelsArr.count)")
         
-        return colorArray
+        return colorArray.reversed()
     }
     
     
diff --git a/Crafty Craft 5/Tab Bar/Create Tab/SkinsCreator/ListOfCreatedSkinsController/Skin2DCreator/BodyPart2DPickerVC/SkinCreatorController/SkinCreatorImportViewController.swift b/Crafty Craft 5/Tab Bar/Create Tab/SkinsCreator/ListOfCreatedSkinsController/Skin2DCreator/BodyPart2DPickerVC/SkinCreatorController/SkinCreatorImportViewController.swift
index 31c13aa..384e478 100755
--- a/Crafty Craft 5/Tab Bar/Create Tab/SkinsCreator/ListOfCreatedSkinsController/Skin2DCreator/BodyPart2DPickerVC/SkinCreatorController/SkinCreatorImportViewController.swift	
+++ b/Crafty Craft 5/Tab Bar/Create Tab/SkinsCreator/ListOfCreatedSkinsController/Skin2DCreator/BodyPart2DPickerVC/SkinCreatorController/SkinCreatorImportViewController.swift	
@@ -138,13 +138,17 @@ final class SkinCreatorImportViewController: UIViewController {
         buttonsStackView.roundCorners()
     }
     
+    
+    
     private func processImported(image: UIImage) {
         guard let width = currentBodyPartSide?.width, let height = currentBodyPartSide?.height else {
             return
         }
         
+        
+        
         guard let rotatedImage = image.rotate(radians: CGFloat.pi/2) else { return }
-        guard let pixelizedImg = rotatedImage.pixelateAndResize(to: .init(width: width, height: height)) else { return }
+        guard let pixelizedImg = image.pixelateAndResize(to: .init(width: width, height: height)) else { return }
         
         guard let colorsArr = pixelizedImg.extractPixelColors(width:width, height: height, startX: 0, startY:0) else {
             return
-- 
2.37.0

